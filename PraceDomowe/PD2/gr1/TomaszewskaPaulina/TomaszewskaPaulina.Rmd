---
title: "Praca domowa nr 2"
author: "Tomaszewska Paulina"
output: html_document
---

Zrealizowane na podstawie pracy studenta: Agata Paldyna

Wprowadzone modyfikacje:
1. W oryginalnym rozwi¹zaniu usuniêto jeden rekord, poniewa¿  skoczek (Zografski) nie mia³ oceny za drugi skok (zosta³ zdyskwalifikowany  po pierwszej serii). Niemniej z racji na dobry skok w pierwszej serii zdoby³ wystarczaj¹co du¿o punktów, aby awansowaæ do rundy fina³owej. Zawsze w drugiej serii uczestniczy 30 zakwalifikowanych skoczków, dlatego usuniêcie jednego rekordu zniekszta³ca rzeczywistoœæ.Dyskwalifikacja po pierwszej serii powoduje jedynie, ¿e zawodnik dostaje zero punktów za drugi skok.
Dlatego te¿ zamieniono wartoœæ oceny za drugi skok z NA  na zero, natomiast wartoœæ NA jako ca³kowit¹ sumê punktów za dwa skoki zmieniono na wartoœæ punktów uzyskan¹ w pierwszej serii. 
Informacjê o dyskwalifikacji zawodnika zaznaczono w ramach "caption", a tak¿e w ramach labels jako "DS".
2. Wiêkszono liczbê informacji explicite widoczn¹ na wykresie poprzez dodanie etykiet (labels), co umo¿liwia porówanie rekordów pod wzgledem iloœciowym, a nie tylko tak jak poprzednio - jakoœciowym. Etykiety zosta³y przedstawione w nastêpuj¹cy sposób: dla skoczka, który uzyska³ najwiêksz¹ liczbê punktów przedstawiono tê liczbê, natomiast dla kolejnych skoczków (z wyj¹tkiem ostatniego) przedstawiono ró¿nicê miêdzy jego wynikiem a wynikiem zwyciêzcy. 
3. Pastelowe kolory s³upków w ramach wykresu kolumnowego zlewa³y siê z szarym t³em, dlatego zmieni³am theme, tak aby t³o by³o bia³e
4. Dla zwiêkszenia czytelnoœci wykresu zmieniono paletê barw z pastelowej ("Set3"), na "Paired", która poprzez "¿ywsze" kolory bardziej przyci¹ga wzrok, a tak¿e pozwala na ³atwiejsze rozró¿nienie poszczególnych kategorii. 
5. W celu lepszego wyodrêbnienia poszczególnych s³upków na wykresie (niektóre mia³y zbli¿ony kolor) zastosowano obwódki s³upków geom_bar(...,color='black')
6. W oryginalnym rozwi¹zaniu przedstawiono informacjê jedynie o ca³kowitej sumie punktów po dwóch seriach, tymczasem ciekawa jest tak¿e informacja o punktach zdobytych przez skoczków w ka¿dej z serii. W tym celu stworzono dwa dodatkowe wykresy, które nastêpnie w ramach pakietu patchwork po³¹czono wraz z bazowym w jeden.


```{R setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
source("https://install-github.me/thomasp85/patchwork")
library(patchwork)

```

### Tworzenie ramki danych

Dane do wykresu zebralam z artykulu znajdujacego sie pod nastepujacym linkiem: <https://wspolczesna.pl/skoki-narciarskie-online-ps-inssbruck-seefeld-2019-konkurs-indywidualny-i-druzynowy-kto-wygral-wyniki-25022019/ar/13906968>.


```{R}
Name <- c("Eisenbichler M.", "Geiger K.", "Peier K.", "Kobayashi R.", "Stoch K.", 
           "Kraft S.", "Forfang J.", "Johansson R.", "Freitag R.", "Zajc T.", 
           "Huber D.", "Kubacki D.", "Aschenwald P.", "Hayboeck M.", "Ammann S.", 
           "Prevc P.", "Kobayashi J.", "Klimov E.", "Zyla P.", "Ito D.", "Sato Y.", 
           "Koudelka R.", "Jelar Z.", "Fettner M.", "Polasek V.", "Schuler A.", 
           "Boyd-Clowes M.", "Learoyd J.", "Stjernen A.", "Zografski V.")
Nationality <- c("GER", "GER", "SUI", "JPN", "POL", "AUT", "NOR", "NOR", "GER", 
                   "SLO", "AUT", "POL", "AUT", "AUT", "SUI", "SLO", "JPN", "RUS", 
                   "POL", "JPN", "JPN", "CZE", "SLO", "AUT", "CZE", "SUI", "CAN", 
                   "FRA", "NOR", "BUL")
Dist1 <- c(131.5, 131.0, 131.0, 133.5, 128.5, 130.0, 132.5, 128.0, 125.5, 127.0, 126.0,
           128.5, 120.0, 122.0, 122.5, 123.5, 116.0, 126.5, 128.5, 119.0, 120.0, 120.5, 
           118.5, 117.5, 120.0, 117.5, 117.0, 116.5, 124.5, 117.0)
Dist2 <- c(135.5, 130.5, 129.5, 126.5, 129.5, 126.5, 125.5, 129.0, 129.5, 124.0, 125.5, 
           125.5, 128.0, 125.5, 126.0, 122.0, 132.0, 121.0, 121.0, 126.0, 124.0, 120.5, 
           121.0, 122.5, 117.5, 119.0, 118.5, 116.5, 102.0, NA)
Total <- c(279.4, 267.3, 266.1, 262.0, 259.4, 256.1, 250.9, 248.9, 248.7, 245.5, 242.0, 
          240.2, 239.9, 233.7, 230.6, 230.5, 230.0, 229.1, 228.7, 225.7, 221.4, 220.1, 
          219.8, 219.0, 218.2, 212.6, 212.1, 205.9, 185.5, NA)

Dist2[length(Dist2)]=0
Total[length(Total)]=Dist1[length(Dist1)]

MS2019_scores <- data.frame(Name, Nationality, Dist1, Dist2, Total)
```

### Wykres

Zdobyte dane ilustruje ponizszy wykres.

```{R}
library(ggplot2)
library(RColorBrewer)

diff_punktowa=max(Total)-Total
diff_punktowa[1]=paste0(max(Total), "pkt.")
for (i in 3:length(diff_punktowa)-1)
{ 
  diff_punktowa[i]=paste0("-", diff_punktowa[i])
}

diff_punktowa[30]="DS"

p1<-ggplot(MS2019_scores, aes(x = reorder(Name, Total), y = Total, fill = Nationality, label=diff_punktowa)) +geom_bar(stat = "identity", color='black') + coord_flip() + ylim(0, 310) +
  scale_fill_brewer(palette = "Paired" , name = "Narodowoœæ") +
  ggtitle("Liczba punktów zdobyta przez 30-tu najlepszych zawodników w konkursie indywidualnym w ramach Mistrzostw Œwiata 2019 w skokach narciarskich") +xlab("") + ylab("Suma punktów")+theme_bw()+ geom_text(hjust=-0.5,size=4.5)+
  labs(caption = paste("*", Name[length(Name)]," zosta³ po pierwszym skoku zdyskwalifikowany, w zestawieniu uwzglêdniono notê po pierwszej serii") )


max_value<-function (data_vector){
labels_data_vector=vector()
for (i in 1:length(data_vector)){
  labels_data_vector[i]=""
  if (data_vector[i]==max(data_vector)){
    labels_data_vector[i]="najwy¿sza nota"
  }
  
}
return (labels_data_vector)
}

label_Dist2=max_value(Dist2)
label_Dist2[30]="DS"

p2<-ggplot(MS2019_scores, aes(x = reorder(Name, Total), y = Dist1, fill = Nationality, label=max_value(Dist1))) +
  geom_bar(stat = "identity", color='black') + coord_flip()  +
  scale_fill_brewer(palette = "Paired" , name = "Narodowoœæ") +geom_text(hjust=-0.1,size=4)+
  ggtitle("Liczba punktów zdobyta w pierwszej serii\n przez 30-tu najlepszych zawodników klasyfikacji generalnej") +xlab("") + ylab("Suma punktów")+theme_bw()+ theme(legend.position = "none")+ylim(0,170)

p3<-ggplot(MS2019_scores, aes(x = reorder(Name, Total), y = Dist2, fill = Nationality, label=label_Dist2)) +
  geom_bar(stat = "identity", color='black') + coord_flip() +
  scale_fill_brewer(palette = "Paired" , name = "Narodowoœæ") +ylim(0,170)+
  ggtitle("Liczba punktów zdobyta w drugiej serii\n przez 30-tu najlepszych zawodników klasyfikacji generalnej")+xlab("") + ylab("Suma punktów")+theme_bw()+theme(legend.position = "none")+ geom_text(hjust=-0.1,size=4)+
labs(caption = paste("*", Name[length(Name)]," zosta³ po pierwszym skoku zdyskwalifikowany, dlatego w fina³owej serii otrzyma³ zero punktów") )

p1/(p2+p3)
```